{% extends "base.html" %}

{% load static %}
{% block javascript-extra %}
    <script src="{% static "js/przepis.js" %}"></script>
{% endblock %}
{% block body %}
    <div class="container wyniki-container">
        <div class="row">
            <div class="col-md-8">
                <ul>
                    {% for recipe in recipes.object_list %}
                        <li><a href="{% url 'recipe_detail' recipe_id=recipe.id %}">{{ recipe.recipe_title }}</a>
                        </li>
                    {% endfor %}
                </ul>
            </div>
            <div class="col-md-4">
                <h5>Ostatnio czytane:</h5>
                <ul id="recipe_list">
                </ul>
            </div>
        </div>
        <div class="row">
            <div class="col-md-4">
                {% if recipes.has_previous %}
                    <div class="pager">
                        <a href="?page={{ recipes.previous_page_number }}" class="btn btn-success" role="button">Poprzednia
                            strona</a>
                    </div>
                {% endif %}
            </div>
            <div class="col-md-4">
                {{ recipes.number }} / {{ recipes.end_index }}
            </div>
            <div class="col-md-4">
                {% if recipes.has_next %}
                    <div class="pager">
                        <a href="?page={{ recipes.next_page_number }}" class="btn btn-success" role="button">Następna
                            strona</a>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
    <script>
        $(document).ready(function () {

            var list=document.getElementById('recipe_list');
            var result;

            let cookie_visited_recipes = $.cookie('visited_recipes');
            if (typeof cookie_visited_recipes !== 'undefined') {

                let visited_recipes = convertCookieToArray(cookie_visited_recipes);
                let recipe_title=convertCookieToArray($.cookie('recipe_name'));
                result = '<ul>';
                for (i = visited_recipes.length-1; i >= 0; i--) {
                    result += '<li><a href="http://127.0.0.1:8000/recipe/' + visited_recipes[i] + '/">' + recipe_title[i] + '</a></li>';
                }
                result += '</ul>';
            }
             else
                {
                    result = '<div>Nie odwiedziłeś jeszcze żadnych przepisów</div>';
                }
            list.insertAdjacentHTML('afterbegin',result);
        });
    </script>
{% endblock %}